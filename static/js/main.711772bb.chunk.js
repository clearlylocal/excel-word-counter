(this["webpackJsonpexcel-word-counter"]=this["webpackJsonpexcel-word-counter"]||[]).push([[0],{24:function(e){e.exports=JSON.parse('{"hash":"9e930d6","ts":"2022-09-02T10:48:25+01:00"}')},44:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(32),s=n.n(a),i=(n(43),n(44),n(17)),o=n(13),u=n(24),l=n(1),j=function(e){var t=e.title,n=e.children;return Object(l.jsx)("span",{title:t,children:n})},d=function(e){var t=Object.assign({},e);return Object(l.jsxs)("footer",Object(o.a)(Object(o.a)({},t),{},{children:[Object(l.jsx)("hr",{}),Object(l.jsx)("div",{className:"footer-text",children:Object(l.jsxs)("small",{children:["Version"," ",Object(l.jsx)(j,{title:u.ts,children:Object(l.jsx)("code",{className:"build-info",children:u.hash})})]})})]}))},b=n(4),h=n(11),f=n(21),O=n(33),p=n(9),x=n(6),v=n(2),m=n(3),g=n(7),w=n(34),y=n.n(w),F=[",","\uff0c",".","\u3002",":","\uff1a",";","\uff1b","[","]","\u3010","]","\u3011","{","\uff5b","}","\uff5d","(","\uff08",")","\uff09","<","\u300a",">","\u300b","$","\uffe5","!","\uff01","?","\uff1f","~","\uff5e","'","\u2019",'"',"\u201c","\u201d","*","/","\\","&","%","@","#","^","\u3001","\u3001","\u3001","\u3001"],C={words:[],count:0},S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||""===e.trim())return C;var n=t.punctuationAsBreaker?" ":"",r=t.disableDefaultPunctuation?[]:F,c=t.punctuation||[],a=r.concat(c);a.forEach((function(t){var r=new RegExp("\\"+t,"g");e=e.replace(r,n)}));var s=(e=(e=e.replace(/[\uFF00-\uFFEF\u2000-\u206F]/g,"")).replace(/\s+/," ")).split(" ");s=s.filter((function(e){return e.trim()}));var i=/[0-9a-zA-Z\-\u00C0-\u00FF\u0100-\u017F\u0180-\u024F\u0250-\u02AF\u1E00-\u1EFF\u0400-\u04FF\u0500-\u052F\u0D00-\u0D7F]+/.source,o="\u2e80-\u2eff\u2f00-\u2fdf\u3000-\u303f\u31c0-\u31ef\u3200-\u32ff\u3300-\u33ff\u3400-\u3fff\u4000-\u4dbf\u4e00-\u4fff\u5000-\u5fff\u6000-\u6fff\u7000-\u7fff\u8000-\u8fff\u9000-\u9fff\uf900-\ufaff",u="\u3040-\u309f\u30a0-\u30ff\u31f0-\u31ff\u3190-\u319f",l="\u1100-\u11ff\u3130-\u318f\ua960-\ua97f\uac00-\uafff\ub000-\ubfff\uc000-\ucfff\ud000-\ud7af\ud7b0-\ud7ff",j=new RegExp("".concat(i,"|[").concat(o).concat(u).concat(l,"]"),"g"),d=[];return s.forEach((function(e){var t,n=[];do{(t=j.exec(e))&&n.push(t[0])}while(t);0===n.length?d.push(e):d=d.concat(n)})),{words:d,count:d.length}},k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=S(e,t),r=n.count;return r},N=n(35),A=n.n(N);window.countWords=k;var P,E,L=function(){var e=Object(g.a)(Object(v.a)().mark((function e(t){var n;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Object(m.a)(t).map(function(){var e=Object(g.a)(Object(v.a)().mark((function e(t){var n,r,c,a,s,i,o;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("application/x-zip-compressed"!==t.type){e.next=19;break}return e.next=3,A.a.loadAsync(t);case 3:n=e.sent,r=[],c=0,a=Object.values(n.files);case 6:if(!(c<a.length)){e.next=18;break}if(!(s=a[c]).dir){e.next=10;break}return e.abrupt("continue",15);case 10:return e.next=12,s.async("blob");case 12:i=e.sent,o=new File([i],s.name,{lastModified:s.date.getTime(),type:"xxx/xxx"}),r.push(o);case 15:c++,e.next=6;break;case 18:return e.abrupt("return",r);case 19:return e.abrupt("return",t);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return n=e.sent,e.abrupt("return",n.flat());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function I(){return(I=Object(g.a)(Object(v.a)().mark((function e(t,n){var r;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=2;break}return e.abrupt("return",null);case 2:return r={countPerUser:{},rowsCountedPerFile:{},languages:{}},e.next=5,L(t);case 5:return t=e.sent,e.next=8,Promise.all(Object(m.a)(t).map((function(e){return new Promise((function(t){var c=M(e.name);if(r.rowsCountedPerFile[e.name]=0,!c)return t();var a=new FileReader;a.onloadend=function(){var s=a.result;(new y.a.Workbook).xlsx.load(s).then((function(a){return a.worksheets.forEach((function(t){var a=U(t),s=a.headers,i=a.rows;if(s&&[n.userCol,n.srcCol].every((function(e){return s.includes(e)}))){var u,l=Object(x.a)(i);try{for(l.s();!(u=l.n()).done;){var j,d,b=u.value,h=k(b[n.srcCol]);h&&(r.countPerUser[b[n.userCol]]=Object(o.a)(Object(o.a)({},r.countPerUser[b[n.userCol]]),{},Object(p.a)({},c,(null!==(j=null===(d=r.countPerUser[b[n.userCol]])||void 0===d?void 0:d[c])&&void 0!==j?j:0)+h)),r.languages[c]=!0,r.rowsCountedPerFile[e.name]+=1)}}catch(f){l.e(f)}finally{l.f()}}})),t()}))},a.readAsArrayBuffer(e)}))})));case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var U=function(e){var t,n=[];return e.eachRow((function(e,r){if(1===r)t=Array.isArray(e.values)?e.values.map((function(e){return String(e).trim()})):[];else{if(!t)return;n.push(Object.fromEntries(t.map((function(t,n){return[t,e.values[n]&&String(e.values[n])]})).filter((function(e){return e&&e[1]}))))}})),{headers:t,rows:n}},W={fileNameFormat:String.raw(P||(P=Object(f.a)(["Need_Translate_To_{{lang}}_for-"]))),srcCol:"eng",userCol:"user_name"},_=Object(o.a)(Object(o.a)({},W),JSON.parse(null!==(E=localStorage.getItem("form"))&&void 0!==E?E:"{}")),M=function(e){var t=_.fileNameFormat.split(/\{\{\s*lang\s*\}\}/),n=Object(h.a)(t,2),r=n[0],c=n[1],a=e.indexOf(r),s=a+r.length,i=e.indexOf(c,s);return[a,i].includes(-1)?null:e.slice(s,i)},R=function(e){var t=e.results,n=t.countPerUser,r=t.rowsCountedPerFile,c=Object.keys(t.languages);return Object(l.jsxs)("div",{children:[Object(l.jsx)("h2",{children:"Rows counted per file"}),Object(l.jsx)("div",{className:"table-scroller table-scroller-y",children:Object(l.jsxs)("table",{children:[Object(l.jsx)("thead",{children:Object(l.jsxs)("tr",{children:[Object(l.jsx)("th",{children:"File"}),Object(l.jsx)("th",{align:"right",children:"Rows counted"})]})}),Object(l.jsx)("tbody",{children:Object.entries(r).map((function(e,t){var n=Object(h.a)(e,2),r=n[0],c=n[1];return Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{children:r}),Object(l.jsx)("td",{align:"right",children:c})]},t)}))})]})}),Object(l.jsx)("hr",{}),Object(l.jsx)("h2",{children:"Word count per user"}),Object(l.jsx)("div",{children:Object(l.jsxs)("table",{children:[Object(l.jsxs)("thead",{children:[Object(l.jsxs)("tr",{children:[Object(l.jsx)("th",{rowSpan:2,children:"User"}),Object(l.jsx)("th",{colSpan:c.length,align:"right",children:"Languages"})]}),Object(l.jsx)("tr",{children:c.map((function(e,t){return Object(l.jsx)("th",{align:"right",children:e},t)}))})]}),Object(l.jsx)("tbody",{children:Object.entries(n).map((function(e,t){var n=Object(h.a)(e,2),r=n[0],a=n[1];return Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{children:r}),c.map((function(e,t){return Object(l.jsx)("td",{align:"right",children:a[e]},t)}))]},t)}))})]})})]})},T=function(){var e=Object(O.a)(),t=e.register,n=e.watch,c=e.handleSubmit,a=Object(r.useMemo)((function(){var e;return null!==(e=n("file"))&&void 0!==e?e:[]}),[n]),s=Object(r.useState)(null),i=Object(h.a)(s,2),o=i[0],u=i[1];return Object(r.useEffect)((function(){(function(e,t){return I.apply(this,arguments)})(a,_).then(u)}),[a]),Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("form",{onChange:c((function(e){localStorage.setItem("form",JSON.stringify(e))})),children:Object(l.jsxs)("label",{children:["Upload files (XLSX or ZIP)",Object(l.jsx)("input",{type:"file",name:"file",multiple:!0,ref:t})]})}),o?Object(l.jsx)("div",{children:Object(l.jsx)(R,{results:o})}):null]})},J=n.p+"static/media/instructions.37f02efc.md";var B,D=n(36),q=function(e){var t,n,r=(t=0,new Proxy(Object.create(null),{get:function(e,n){return n in e?e[n]:t}})),c=Object(x.a)(e.querySelectorAll("h2, h3, h4, h5, h6, .anchored"));try{for(c.s();!(n=c.n()).done;){var a=n.value;if(a.textContent){var s=a.textContent.toLowerCase().replace(Object(D.regex)("gu")(B||(B=Object(f.a)(["[\n\t\t\t\t^\n\t\t\t\tp{Letter}\n\t\t\t\tp{Mark}\n\t\t\t\tp{Number}\n\t\t\t]+"],["[\n\t\t\t\t^\n\t\t\t\t\\p{Letter}\n\t\t\t\t\\p{Mark}\n\t\t\t\t\\p{Number}\n\t\t\t]+"])))," ").trim().replace(/\s+/g,"-")||"heading",i=++r[s];a.id=[s,i>1&&i].filter(Boolean).join("-"),a.classList.add("anchored")}}}catch(o){c.e(o)}finally{c.f()}},V=function(e){window.location.hash&&setTimeout((function(){var t=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((function(e,t){return t(e)}),e)}(window.location.hash.slice(1),decodeURIComponent,CSS.escape,(function(t){return e.querySelector("#".concat(t))}));null===t||void 0===t||t.scrollIntoView(!0)}),100)},z=n(25),X=function(){var e,t=Object(r.useState)(""),n=Object(h.a)(t,2),c=n[0],a=n[1],s=Object(b.f)();return Object(r.useEffect)((function(){fetch(J,{cache:"force-cache"}).then(function(){var e=Object(g.a)(Object(v.a)().mark((function e(t){var n,r;return Object(v.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.text();case 2:n=e.sent,r=n.split(/((?<=^|\n)```\r?\n[\s\S]*?\r?\n```)/).map((function(e,t){return t%2?"<pre><code>".concat(e.split(/\r?\n/).slice(1,-1).join("\n"),"</pre></code>"):e.split(/(?:\r?\n){2,}/).map((function(e){return[" ","\t","#","-","*","`","~"].some((function(t){return e.startsWith(t)}))?/^\s*-{3,}\s*$/.test(e)?"<hr>":Object(z.a)(e):"<p>".concat(Object(z.a)(e),"</p>")})).join("")})).join("").replace(/<p><\/p>/g,""),a(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(l.jsx)("div",{ref:(e=function(e){q(e),function(e){var t,n=Object(x.a)(e.querySelectorAll("a"));try{for(n.s();!(t=n.n()).done;){var r=t.value,c=r.getAttribute("href");null!==c&&void 0!==c&&c.startsWith("/")&&r.setAttribute("href","/excel-word-counter"+c)}}catch(a){n.e(a)}finally{n.f()}}(e),function(e,t){e.addEventListener("click",(function(e){var n=e.target,r=n.getAttribute("href");"A"===n.nodeName&&r?(e.preventDefault(),r.startsWith("http")&&!r.startsWith(window.location.origin)?window.open(r,"_blank","noopener noreferrer"):t.push(r.slice("/excel-word-counter".length))):n.classList.contains("anchored")&&(window.location.hash=n.id,n.scrollIntoView(!0))}))}(e,s),V(e)},function(t){if(t){var n=new MutationObserver((function(r){e(t),n.disconnect()}));n.observe(t,{childList:!0})}}),dangerouslySetInnerHTML:{__html:c}})},Z=function(){return Object(l.jsxs)(b.c,{children:[Object(l.jsx)(b.a,{exact:!0,path:"/",children:Object(l.jsx)(T,{})}),Object(l.jsx)(b.a,{path:"/instructions",children:Object(l.jsx)(X,{})})]})},$=function(){return Object(l.jsx)(l.Fragment,{children:Object(l.jsx)(i.a,{basename:"/excel-word-counter",children:Object(l.jsxs)("div",{className:"full-page",children:[Object(l.jsxs)("nav",{className:"tabs",children:[Object(l.jsx)("img",{className:"site-title",alt:"Clearly Local",src:"/excel-word-counter/cl-logo-small.png"}),Object(l.jsx)(i.b,{exact:!0,activeClassName:"active",to:"/",children:"Word Counter"}),Object(l.jsx)(i.b,{activeClassName:"active",to:"/instructions",children:"Instructions"})]}),Object(l.jsx)("main",{className:"container",children:Object(l.jsx)(Z,{})}),Object(l.jsx)(d,{className:"container"})]})})})};s.a.render(Object(l.jsx)(c.a.StrictMode,{children:Object(l.jsx)($,{})}),document.getElementById("root"))}},[[71,1,2]]]);
//# sourceMappingURL=main.711772bb.chunk.js.map