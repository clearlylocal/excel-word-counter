(this["webpackJsonpexcel-word-counter"]=this["webpackJsonpexcel-word-counter"]||[]).push([[0],{43:function(e,t,n){},44:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(31),i=n.n(a),s=(n(42),n(43),n(16)),o=n(11),u=n(17),l=n(21),j=n(32),d=(n(44),n(9)),f=n(6),h=n(2),b=n(3),p=n(7),O=n(33),x=n.n(O),g=[",","\uff0c",".","\u3002",":","\uff1a",";","\uff1b","[","]","\u3010","]","\u3011","{","\uff5b","}","\uff5d","(","\uff08",")","\uff09","<","\u300a",">","\u300b","$","\uffe5","!","\uff01","?","\uff1f","~","\uff5e","'","\u2019",'"',"\u201c","\u201d","*","/","\\","&","%","@","#","^","\u3001","\u3001","\u3001","\u3001"],v={words:[],count:0},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||""===e.trim())return v;var n=t.punctuationAsBreaker?" ":"",r=t.disableDefaultPunctuation?[]:g,c=t.punctuation||[],a=r.concat(c);a.forEach((function(t){var r=new RegExp("\\"+t,"g");e=e.replace(r,n)}));var i=(e=(e=e.replace(/[\uFF00-\uFFEF\u2000-\u206F]/g,"")).replace(/\s+/," ")).split(" ");i=i.filter((function(e){return e.trim()}));var s="(\\d+)|[a-zA-Z\xc0-\xff\u0100-\u017f\u0180-\u024f\u0250-\u02af\u1e00-\u1eff\u0400-\u04ff\u0500-\u052f\u0d00-\u0d7f]+|",o="\u2e80-\u2eff\u2f00-\u2fdf\u3000-\u303f\u31c0-\u31ef\u3200-\u32ff\u3300-\u33ff\u3400-\u3fff\u4000-\u4dbf\u4e00-\u4fff\u5000-\u5fff\u6000-\u6fff\u7000-\u7fff\u8000-\u8fff\u9000-\u9fff\uf900-\ufaff",u="\u3040-\u309f\u30a0-\u30ff\u31f0-\u31ff\u3190-\u319f",l="\u1100-\u11ff\u3130-\u318f\ua960-\ua97f\uac00-\uafff\ub000-\ubfff\uc000-\ucfff\ud000-\ud7af\ud7b0-\ud7ff",j=new RegExp(s+"["+o+u+l+"]","g"),d=[];return i.forEach((function(e){var t,n=[];do{(t=j.exec(e))&&n.push(t[0])}while(t);0===n.length?d.push(e):d=d.concat(n)})),{words:d,count:d.length}},w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=m(e,t),r=n.count;return r},y=n(34),C=n.n(y),S=function(){var e=Object(p.a)(Object(h.a)().mark((function e(t){var n;return Object(h.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Object(b.a)(t).map(function(){var e=Object(p.a)(Object(h.a)().mark((function e(t){var n,r,c,a,i,s,o;return Object(h.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("application/x-zip-compressed"!==t.type){e.next=19;break}return e.next=3,C.a.loadAsync(t);case 3:n=e.sent,r=[],c=0,a=Object.values(n.files);case 6:if(!(c<a.length)){e.next=18;break}if(!(i=a[c]).dir){e.next=10;break}return e.abrupt("continue",15);case 10:return e.next=12,i.async("blob");case 12:s=e.sent,o=new File([s],i.name,{lastModified:i.date.getTime(),type:"xxx/xxx"}),r.push(o);case 15:c++,e.next=6;break;case 18:return e.abrupt("return",r);case 19:return e.abrupt("return",t);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return n=e.sent,e.abrupt("return",n.flat());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function k(){return(k=Object(p.a)(Object(h.a)().mark((function e(t,n){var r;return Object(h.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=2;break}return e.abrupt("return",null);case 2:return r={countPerLinguist:{},rowsCountedPerFile:{},languages:{}},e.next=5,S(t);case 5:return t=e.sent,e.next=8,Promise.all(Object(b.a)(t).map((function(e){return new Promise((function(t){var c=I(e.name);if(r.rowsCountedPerFile[e.name]=0,!c)return t();var a=new FileReader;a.onloadend=function(){var i=a.result;(new x.a.Workbook).xlsx.load(i).then((function(a){return a.worksheets.forEach((function(t){var a=A(t),i=a.headers,s=a.rows;if(i&&[n.linguistCol,n.srcCol].every((function(e){return i.includes(e)}))){var o,l=Object(f.a)(s);try{for(l.s();!(o=l.n()).done;){var j,h,b=o.value;if(b[c]){var p=w(b[n.srcCol]);p&&(r.countPerLinguist[b[n.linguistCol]]=Object(u.a)(Object(u.a)({},r.countPerLinguist[b[n.linguistCol]]),{},Object(d.a)({},c,(null!==(j=null===(h=r.countPerLinguist[b[n.linguistCol]])||void 0===h?void 0:h[c])&&void 0!==j?j:0)+p)),r.languages[c]=!0,r.rowsCountedPerFile[e.name]+=1)}}}catch(O){l.e(O)}finally{l.f()}}})),t()}))},a.readAsArrayBuffer(e)}))})));case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var F,L,P=n(1),A=function(e){var t,n=[];return e.eachRow((function(e,r){if(1===r)t=Array.isArray(e.values)?e.values.map((function(e){return String(e).trim()})):[];else{if(!t)return;n.push(Object.fromEntries(t.map((function(t,n){return[t,e.values[n]&&String(e.values[n])]})).filter((function(e){return e&&e[1]}))))}})),{headers:t,rows:n}},N={fileNameFormat:String.raw(F||(F=Object(l.a)(["Need_Translate_To_{{lang}}_for-"]))),srcCol:"eng",linguistCol:"user_name"},E=Object(u.a)(Object(u.a)({},N),JSON.parse(null!==(L=localStorage.getItem("form"))&&void 0!==L?L:"{}")),I=function(e){var t=E.fileNameFormat.split(/\{\{\s*lang\s*\}\}/),n=Object(o.a)(t,2),r=n[0],c=n[1],a=e.indexOf(r),i=a+r.length,s=e.indexOf(c,i);return[a,s].includes(-1)?null:e.slice(i,s)},_=function(e){var t=e.results,n=t.countPerLinguist,r=t.rowsCountedPerFile,c=Object.keys(t.languages);return Object(P.jsxs)("div",{children:[Object(P.jsx)("h2",{children:"Rows counted per file"}),Object(P.jsxs)("table",{children:[Object(P.jsx)("thead",{children:Object(P.jsxs)("tr",{children:[Object(P.jsx)("th",{children:"File"}),Object(P.jsx)("th",{align:"right",children:"Rows counted"})]})}),Object(P.jsx)("tbody",{children:Object.entries(r).map((function(e,t){var n=Object(o.a)(e,2),r=n[0],c=n[1];return Object(P.jsxs)("tr",{children:[Object(P.jsx)("td",{children:r}),Object(P.jsx)("td",{align:"right",children:c})]},t)}))})]}),Object(P.jsx)("hr",{}),Object(P.jsx)("h2",{children:"Count per linguist"}),Object(P.jsxs)("table",{children:[Object(P.jsxs)("thead",{children:[Object(P.jsxs)("tr",{children:[Object(P.jsx)("th",{rowSpan:2,children:"Linguist"}),Object(P.jsx)("th",{colSpan:c.length,align:"right",children:"Languages"})]}),Object(P.jsx)("tr",{children:c.map((function(e,t){return Object(P.jsx)("th",{align:"right",children:e},t)}))})]}),Object(P.jsx)("tbody",{children:Object.entries(n).map((function(e,t){var n=Object(o.a)(e,2),r=n[0],a=n[1];return Object(P.jsxs)("tr",{children:[Object(P.jsx)("td",{children:r}),c.map((function(e,t){return Object(P.jsx)("td",{align:"right",children:a[e]},t)}))]},t)}))})]})]})},M=function(){var e=Object(j.a)(),t=e.register,n=e.watch,c=e.handleSubmit,a=Object(r.useMemo)((function(){var e;return null!==(e=n("file"))&&void 0!==e?e:[]}),[n]),i=Object(r.useState)(null),s=Object(o.a)(i,2),u=s[0],l=s[1];return Object(r.useEffect)((function(){(function(e,t){return k.apply(this,arguments)})(a,E).then(l)}),[a]),Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("form",{onChange:c((function(e){localStorage.setItem("form",JSON.stringify(e))})),children:Object(P.jsxs)("label",{children:["Upload files (XLSX or ZIP)",Object(P.jsx)("input",{type:"file",name:"file",multiple:!0,ref:t})]})}),u?Object(P.jsx)("div",{children:Object(P.jsx)(_,{results:u})}):null]})},R=n(4),W=n.p+"static/media/instructions.47a28d49.md";var T,B=n(35),J=function(e){var t,n,r=(t=0,new Proxy(Object.create(null),{get:function(e,n){return n in e?e[n]:t}})),c=Object(f.a)(e.querySelectorAll("h2, h3, h4, h5, h6, .anchored"));try{for(c.s();!(n=c.n()).done;){var a=n.value;if(a.textContent){var i=a.textContent.toLowerCase().replace(Object(B.regex)("gu")(T||(T=Object(l.a)(["[\n\t\t\t\t^\n\t\t\t\tp{Letter}\n\t\t\t\tp{Mark}\n\t\t\t\tp{Number}\n\t\t\t]+"],["[\n\t\t\t\t^\n\t\t\t\t\\p{Letter}\n\t\t\t\t\\p{Mark}\n\t\t\t\t\\p{Number}\n\t\t\t]+"])))," ").trim().replace(/\s+/g,"-")||"heading",s=++r[i];a.id=[i,s>1&&s].filter(Boolean).join("-"),a.classList.add("anchored")}}}catch(o){c.e(o)}finally{c.f()}},q=function(e){window.location.hash&&setTimeout((function(){var t=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((function(e,t){return t(e)}),e)}(window.location.hash.slice(1),decodeURIComponent,CSS.escape,(function(t){return e.querySelector("#".concat(t))}));null===t||void 0===t||t.scrollIntoView(!0)}),100)},z=n(24),D=function(){var e,t=Object(r.useState)(""),n=Object(o.a)(t,2),c=n[0],a=n[1],i=Object(R.f)();return Object(r.useEffect)((function(){fetch(W,{cache:"force-cache"}).then(function(){var e=Object(p.a)(Object(h.a)().mark((function e(t){var n,r;return Object(h.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.text();case 2:n=e.sent,r=n.split(/((?<=^|\n)```\r?\n[\s\S]*?\r?\n```)/).map((function(e,t){return t%2?"<pre><code>".concat(e.split(/\r?\n/).slice(1,-1).join("\n"),"</pre></code>"):e.split(/(?:\r?\n){2,}/).map((function(e){return[" ","\t","#","-","*","`","~"].some((function(t){return e.startsWith(t)}))?/^\s*-{3,}\s*$/.test(e)?"<hr>":Object(z.a)(e):"<p>".concat(Object(z.a)(e),"</p>")})).join("")})).join("").replace(/<p><\/p>/g,""),a(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(P.jsx)("div",{ref:(e=function(e){J(e),function(e){var t,n=Object(f.a)(e.querySelectorAll("a"));try{for(n.s();!(t=n.n()).done;){var r=t.value,c=r.getAttribute("href");null!==c&&void 0!==c&&c.startsWith("/")&&r.setAttribute("href","/excel-word-counter"+c)}}catch(a){n.e(a)}finally{n.f()}}(e),function(e,t){e.addEventListener("click",(function(e){var n=e.target,r=n.getAttribute("href");"A"===n.nodeName&&r?(e.preventDefault(),r.startsWith("http")&&!r.startsWith(window.location.origin)?window.open(r,"_blank","noopener noreferrer"):t.push(r.slice("/excel-word-counter".length))):n.classList.contains("anchored")&&(window.location.hash=n.id,n.scrollIntoView(!0))}))}(e,i),q(e)},function(t){if(t){var n=new MutationObserver((function(r){e(t),n.disconnect()}));n.observe(t,{childList:!0})}}),dangerouslySetInnerHTML:{__html:c}})},U=function(){return Object(P.jsxs)(R.c,{children:[Object(P.jsx)(R.a,{exact:!0,path:"/",children:Object(P.jsx)(M,{})}),Object(P.jsx)(R.a,{path:"/instructions",children:Object(P.jsx)(D,{})})]})},V=function(){return Object(P.jsx)(P.Fragment,{children:Object(P.jsxs)(s.a,{basename:"/excel-word-counter",children:[Object(P.jsxs)("nav",{className:"tabs",children:[Object(P.jsx)("img",{className:"site-title",alt:"Clearly Local",src:"./cl-logo-small.png"}),Object(P.jsx)(s.b,{exact:!0,activeClassName:"active",to:"/",children:"Word Counter"}),Object(P.jsx)(s.b,{activeClassName:"active",to:"/instructions",children:"Instructions"})]}),Object(P.jsx)("main",{className:"container",children:Object(P.jsx)(U,{})})]})})};i.a.render(Object(P.jsx)(c.a.StrictMode,{children:Object(P.jsx)(V,{})}),document.getElementById("root"))}},[[71,1,2]]]);
//# sourceMappingURL=main.737328fd.chunk.js.map