(this["webpackJsonpexcel-word-counter"]=this["webpackJsonpexcel-word-counter"]||[]).push([[0],{25:function(e){e.exports=JSON.parse('{"hash":"02bebd4","ts":"2022-09-08T17:15:38+01:00"}')},44:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(33),s=n.n(a),o=(n(43),n(44),n(17)),i=n(13),u=n(25),l=n(1),j=function(e){var t=e.title,n=e.children;return Object(l.jsx)("span",{title:t,children:n})},b=function(e){var t=Object.assign({},e);return Object(l.jsxs)("footer",Object(i.a)(Object(i.a)({},t),{},{children:[Object(l.jsx)("hr",{}),Object(l.jsx)("div",{className:"footer-text",children:Object(l.jsxs)("small",{children:["Version"," ",Object(l.jsx)(j,{title:u.ts,children:Object(l.jsx)("code",{className:"build-info",children:u.hash})})]})})]}))},d=n(4),f=n(5),h=n(34),O=n(10),p=n(7),x=n(2),v=n(3),g=n(8),m=n(21),w=n.n(m),y=[",","\uff0c",".","\u3002",":","\uff1a",";","\uff1b","[","]","\u3010","]","\u3011","{","\uff5b","}","\uff5d","(","\uff08",")","\uff09","<","\u300a",">","\u300b","$","\uffe5","!","\uff01","?","\uff1f","~","\uff5e","'","\u2019",'"',"\u201c","\u201d","*","/","\\","&","%","@","#","^","\u3001","\u3001","\u3001","\u3001"],C={words:[],count:0},F=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||""===e.trim())return C;var n=t.punctuationAsBreaker?" ":"",r=t.disableDefaultPunctuation?[]:y,c=t.punctuation||[],a=r.concat(c);a.forEach((function(t){var r=new RegExp("\\"+t,"g");e=e.replace(r,n)}));var s=(e=(e=e.replace(/[\uFF00-\uFFEF\u2000-\u206F]/g,"")).replace(/\s+/," ")).split(" ");s=s.filter((function(e){return e.trim()}));var o=/[0-9a-zA-Z\-\u00C0-\u00FF\u0100-\u017F\u0180-\u024F\u0250-\u02AF\u1E00-\u1EFF\u0400-\u04FF\u0500-\u052F\u0D00-\u0D7F]+/.source,i="\u2e80-\u2eff\u2f00-\u2fdf\u3000-\u303f\u31c0-\u31ef\u3200-\u32ff\u3300-\u33ff\u3400-\u3fff\u4000-\u4dbf\u4e00-\u4fff\u5000-\u5fff\u6000-\u6fff\u7000-\u7fff\u8000-\u8fff\u9000-\u9fff\uf900-\ufaff",u="\u3040-\u309f\u30a0-\u30ff\u31f0-\u31ff\u3190-\u319f",l="\u1100-\u11ff\u3130-\u318f\ua960-\ua97f\uac00-\uafff\ub000-\ubfff\uc000-\ucfff\ud000-\ud7af\ud7b0-\ud7ff",j=new RegExp("".concat(o,"|[").concat(i).concat(u).concat(l,"]"),"g"),b=[];return s.forEach((function(e){var t,n=[];do{(t=j.exec(e))&&n.push(t[0])}while(t);0===n.length?b.push(e):b=b.concat(n)})),{words:b,count:b.length}},k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=F(e,t),r=n.count;return r};function S(e){var t,n=[];return e.eachRow((function(e,r){if(1===r)t=Array.isArray(e.values)?e.values.map((function(e){return String(e).trim()})):[];else{if(!t)return;n.push(Object.fromEntries(t.map((function(t,n){return[t,e.values[n]&&String(e.values[n])]})).filter((function(e){return e&&e[1]}))))}})),{headers:t,rows:n}}var N=n(35),A=n.n(N);window.countWords=k;var P=function(){var e=Object(g.a)(Object(x.a)().mark((function e(t){var n;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Object(v.a)(t).map(function(){var e=Object(g.a)(Object(x.a)().mark((function e(t){var n,r,c,a,s,o,i;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("application/x-zip-compressed"!==t.type){e.next=19;break}return e.next=3,A.a.loadAsync(t);case 3:n=e.sent,r=[],c=0,a=Object.values(n.files);case 6:if(!(c<a.length)){e.next=18;break}if(!(s=a[c]).dir){e.next=10;break}return e.abrupt("continue",15);case 10:return e.next=12,s.async("blob");case 12:o=e.sent,i=new File([o],s.name,{lastModified:s.date.getTime(),type:"xxx/xxx"}),r.push(i);case 15:c++,e.next=6;break;case 18:return e.abrupt("return",r);case 19:return e.abrupt("return",t);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return n=e.sent,e.abrupt("return",n.flat());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function R(){return(R=Object(g.a)(Object(x.a)().mark((function e(t,n){var r;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=2;break}return e.abrupt("return",null);case 2:return r={countPerUser:{},rowsCountedPerFile:{},languages:{}},e.next=5,P(t);case 5:return t=e.sent,e.next=8,Promise.all(Object(v.a)(t).map((function(e){return new Promise((function(t){var c=D(e.name);if(r.rowsCountedPerFile[e.name]=0,!c)return t();var a=new FileReader;a.onloadend=function(){var s=a.result;(new w.a.Workbook).xlsx.load(s).then((function(a){return a.worksheets.forEach((function(t){var a=S(t),s=a.headers,o=a.rows;if(s&&[n.userCol,n.srcCol].every((function(e){return s.includes(e)}))){var u,l=Object(p.a)(o);try{for(l.s();!(u=l.n()).done;){var j,b,d=u.value,f=k(d[n.srcCol]);f&&(r.countPerUser[d[n.userCol]]=Object(i.a)(Object(i.a)({},r.countPerUser[d[n.userCol]]),{},Object(O.a)({},c,(null!==(j=null===(b=r.countPerUser[d[n.userCol]])||void 0===b?void 0:b[c])&&void 0!==j?j:0)+f)),r.languages[c]=!0,r.rowsCountedPerFile[e.name]+=1)}}catch(h){l.e(h)}finally{l.f()}}})),t()}))},a.readAsArrayBuffer(e)}))})));case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E=function(e){var t=e.countPerUser,n=e.rowsCountedPerFile,r=Object.keys(e.languages),c=new w.a.Workbook,a=c.addWorksheet("Wordcounts",{views:[{state:"frozen",xSplit:0,ySplit:2}]}),s=r.length+1;a.autoFilter={from:{row:2,column:1},to:{row:2,column:s}},a.getRow(1).values=["User","Languages"],a.getRow(2).values=[""].concat(r);for(var o=0,i=[1,2];o<i.length;o++){var u=i[o];a.getRow(u).font={bold:!0}}a.mergeCells("A1:A2"),a.mergeCells(1,2,1,s),a.getCell("B1").alignment={horizontal:"right"},a.getColumn("A").width=30;var l,j=Object(p.a)(Object.entries(t).entries());try{var b=function(){var e=Object(f.a)(l.value,2),t=e[0],n=Object(f.a)(e[1],2),c=n[0],s=n[1];a.getRow(3+t).values=[c].concat(Object(v.a)(r.map((function(e){return s[e]}))))};for(j.s();!(l=j.n()).done;)b()}catch(F){j.e(F)}finally{j.f()}var d=c.addWorksheet("Stats",{views:[{state:"frozen",xSplit:0,ySplit:1}]});d.getRow(1).values=["File","Rows counted"],d.getRow(1).font={bold:!0},d.getColumn("A").width=65;var h,O=Object(p.a)(Object.entries(n).entries());try{for(O.s();!(h=O.n()).done;){var x=Object(f.a)(h.value,2),g=x[0],m=Object(f.a)(x[1],2),y=m[0],C=m[1];d.getRow(2+g).values=[y,C]}}catch(F){O.e(F)}finally{O.f()}return c};function L(){return(L=Object(g.a)(Object(x.a)().mark((function e(t){var n,r,c,a;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=E(t),e.next=3,n.xlsx.writeBuffer({});case 3:r=e.sent,c=document.createElement("a"),a=new Blob([r],{type:"image/jpeg"}),c.href=URL.createObjectURL(a),c.download="wordcounts_".concat((new Date).toISOString().replace(/\D/g,""),".xlsx"),c.click();case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){var t=e.results,n=t.countPerUser,c=t.rowsCountedPerFile,a=Object.keys(t.languages),s=Object(r.useCallback)((function(){!function(e){L.apply(this,arguments)}(t)}),[t]);return Object(l.jsxs)("div",{children:[Object(l.jsx)("br",{}),Object(l.jsx)("button",{className:"button primary",onClick:s,children:"Export"}),Object(l.jsx)("h2",{children:"Rows counted per file"}),Object(l.jsx)("div",{className:"table-scroller table-scroller-y",children:Object(l.jsxs)("table",{children:[Object(l.jsx)("thead",{children:Object(l.jsxs)("tr",{children:[Object(l.jsx)("th",{children:"File"}),Object(l.jsx)("th",{align:"right",children:"Rows counted"})]})}),Object(l.jsx)("tbody",{children:Object.entries(c).map((function(e,t){var n=Object(f.a)(e,2),r=n[0],c=n[1];return Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{children:r}),Object(l.jsx)("td",{align:"right",children:c})]},t)}))})]})}),Object(l.jsx)("hr",{}),Object(l.jsx)("h2",{children:"Word count per user"}),Object(l.jsx)("div",{children:Object(l.jsxs)("table",{children:[Object(l.jsxs)("thead",{children:[Object(l.jsxs)("tr",{children:[Object(l.jsx)("th",{rowSpan:2,children:"User"}),Object(l.jsx)("th",{colSpan:a.length,align:"right",children:"Languages"})]}),Object(l.jsx)("tr",{children:a.map((function(e,t){return Object(l.jsx)("th",{align:"right",children:e},t)}))})]}),Object(l.jsx)("tbody",{children:Object.entries(n).map((function(e,t){var n=Object(f.a)(e,2),r=n[0],c=n[1];return Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{children:r}),a.map((function(e,t){return Object(l.jsx)("td",{align:"right",children:c[e]},t)}))]},t)}))})]})})]})}var W,I,_=n(22),B={fileNameFormat:String.raw(W||(W=Object(_.a)(["Need_Translate_To_{{lang}}_for-"]))),srcCol:"eng",userCol:"user_name"},M=Object(i.a)(Object(i.a)({},B),JSON.parse(null!==(I=localStorage.getItem("form"))&&void 0!==I?I:"{}")),D=function(e){var t=M.fileNameFormat.split(/\{\{\s*lang\s*\}\}/),n=Object(f.a)(t,2),r=n[0],c=n[1],a=e.indexOf(r),s=a+r.length,o=e.indexOf(c,s);return[a,o].includes(-1)?null:e.slice(s,o)},T=function(){var e=Object(h.a)(),t=e.register,n=e.watch,c=e.handleSubmit,a=Object(r.useMemo)((function(){var e;return null!==(e=n("file"))&&void 0!==e?e:[]}),[n]),s=Object(r.useState)(null),o=Object(f.a)(s,2),i=o[0],u=o[1];return Object(r.useEffect)((function(){(function(e,t){return R.apply(this,arguments)})(a,M).then(u)}),[a]),Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("form",{onChange:c((function(e){localStorage.setItem("form",JSON.stringify(e))})),children:Object(l.jsxs)("label",{children:["Upload files (XLSX or ZIP)",Object(l.jsx)("input",{type:"file",name:"file",multiple:!0,ref:t})]})}),i?Object(l.jsx)("div",{children:Object(l.jsx)(U,{results:i})}):null]})},z=n.p+"static/media/instructions.5795dcfb.md";var J,q=n(36),V=function(e){var t,n,r=(t=0,new Proxy(Object.create(null),{get:function(e,n){return n in e?e[n]:t}})),c=Object(p.a)(e.querySelectorAll("h2, h3, h4, h5, h6, .anchored"));try{for(c.s();!(n=c.n()).done;){var a=n.value;if(a.textContent){var s=a.textContent.toLowerCase().replace(Object(q.regex)("gu")(J||(J=Object(_.a)(["[\n\t\t\t\t^\n\t\t\t\tp{Letter}\n\t\t\t\tp{Mark}\n\t\t\t\tp{Number}\n\t\t\t]+"],["[\n\t\t\t\t^\n\t\t\t\t\\p{Letter}\n\t\t\t\t\\p{Mark}\n\t\t\t\t\\p{Number}\n\t\t\t]+"])))," ").trim().replace(/\s+/g,"-")||"heading",o=++r[s];a.id=[s,o>1&&o].filter(Boolean).join("-"),a.classList.add("anchored")}}}catch(i){c.e(i)}finally{c.f()}},X=function(e){window.location.hash&&setTimeout((function(){var t=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((function(e,t){return t(e)}),e)}(window.location.hash.slice(1),decodeURIComponent,CSS.escape,(function(t){return e.querySelector("#".concat(t))}));null===t||void 0===t||t.scrollIntoView(!0)}),100)},Z=n(26),$=function(){var e,t=Object(r.useState)(""),n=Object(f.a)(t,2),c=n[0],a=n[1],s=Object(d.f)();return Object(r.useEffect)((function(){fetch(z,{cache:"force-cache"}).then(function(){var e=Object(g.a)(Object(x.a)().mark((function e(t){var n,r;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.text();case 2:n=e.sent,r=n.split(/((?<=^|\n)```\r?\n[\s\S]*?\r?\n```)/).map((function(e,t){return t%2?"<pre><code>".concat(e.split(/\r?\n/).slice(1,-1).join("\n"),"</pre></code>"):e.split(/(?:\r?\n){2,}/).map((function(e){return[" ","\t","#","-","*","`","~"].some((function(t){return e.startsWith(t)}))?/^\s*-{3,}\s*$/.test(e)?"<hr>":Object(Z.a)(e):"<p>".concat(Object(Z.a)(e),"</p>")})).join("")})).join("").replace(/<p><\/p>/g,""),a(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(l.jsx)("div",{ref:(e=function(e){V(e),function(e){var t,n=Object(p.a)(e.querySelectorAll("a"));try{for(n.s();!(t=n.n()).done;){var r=t.value,c=r.getAttribute("href");null!==c&&void 0!==c&&c.startsWith("/")&&r.setAttribute("href","/excel-word-counter"+c)}}catch(a){n.e(a)}finally{n.f()}}(e),function(e,t){e.addEventListener("click",(function(e){var n=e.target,r=n.getAttribute("href");"A"===n.nodeName&&r?(e.preventDefault(),r.startsWith("http")&&!r.startsWith(window.location.origin)?window.open(r,"_blank","noopener noreferrer"):t.push(r.slice("/excel-word-counter".length))):n.classList.contains("anchored")&&(window.location.hash=n.id,n.scrollIntoView(!0))}))}(e,s),X(e)},function(t){if(t){var n=new MutationObserver((function(r){e(t),n.disconnect()}));n.observe(t,{childList:!0})}}),dangerouslySetInnerHTML:{__html:c}})},H=function(){return Object(l.jsxs)(d.c,{children:[Object(l.jsx)(d.a,{exact:!0,path:"/",children:Object(l.jsx)(T,{})}),Object(l.jsx)(d.a,{path:"/instructions",children:Object(l.jsx)($,{})})]})},G=function(){return Object(l.jsx)(l.Fragment,{children:Object(l.jsx)(o.a,{basename:"/excel-word-counter",children:Object(l.jsxs)("div",{className:"full-page",children:[Object(l.jsxs)("nav",{className:"tabs",children:[Object(l.jsx)("img",{className:"site-title",alt:"Clearly Local",src:"/excel-word-counter/cl-logo-small.png"}),Object(l.jsx)(o.b,{exact:!0,activeClassName:"active",to:"/",children:"Word Counter"}),Object(l.jsx)(o.b,{activeClassName:"active",to:"/instructions",children:"Instructions"})]}),Object(l.jsx)("main",{className:"container",children:Object(l.jsx)(H,{})}),Object(l.jsx)(b,{className:"container"})]})})})};s.a.render(Object(l.jsx)(c.a.StrictMode,{children:Object(l.jsx)(G,{})}),document.getElementById("root"))}},[[71,1,2]]]);
//# sourceMappingURL=main.7d30da7a.chunk.js.map